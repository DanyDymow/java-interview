## Shared lock

- Shared lock 

совместная блокировка, позволяет другим транзакциям читать строку и ставить на нее такую же совместную блокировку, но не позволяет изменять строку или ставить исключительную блокировку.

- Exclusive lock 

 исключительная блокировка, запрещает другим транзакциям блокировать строку, а также может блокировать строку как на запись, так и на чтение в зависимости от текущего уровня изоляции (о коих ниже).

- Оптимистическая блокировка (Optimistic Locking)

Оптимистическая блокировка основана на предположении, что конфликты блокировки редки и что большинство транзакций не будут конфликтовать друг с другом. При использовании оптимистической блокировки Hibernate не блокирует данные во время чтения, а только проверяет их состояние перед сохранением изменений. Если данные были изменены другой транзакцией, Hibernate генерирует исключение OptimisticLockException и позволяет вам обработать конфликт.

Оптимистическая блокировка в Hibernate реализуется с помощью механизма версионирования. Каждая сущность имеет поле версии, которое автоматически инкрементируется при каждом изменении. При сохранении изменений Hibernate проверяет, соответствует ли версия в базе данных версии, которую вы пытаетесь сохранить. Если версии не совпадают, генерируется исключение OptimisticLockException.

Для оптимистических блокировок все уже сделано за нас - это AtomicInteger. Если посмотреть на код AtomicInteger, то там обнаружится 
обычная volatile переменная
```java
private volatile int value;
```
И функция которая обновляет эту переменную с помощью Compare-and-swap (CAS) алгоритма:
```java
public final native boolean compareAndSetInt(Object o, long offset, int expected, int x);
```

- Пессимистическая блокировка (Pessimistic Locking)

Пессимистическая блокировка основана на предположении, что конфликты блокировки часто возникают и что большинство транзакций будет конфликтовать друг с другом. При использовании пессимистической блокировки Hibernate блокирует данные во время чтения, чтобы предотвратить другие транзакции от изменения этих данных до завершения текущей транзакции.

В Hibernate пессимистическая блокировка может быть реализована с помощью различных стратегий блокировки, таких как блокировка на уровне строки или блокировка на уровне таблицы. Вы можете выбрать подходящую стратегию блокировки в зависимости от требований вашего приложения.

Для пессимистических блокировок наиболее простым решением будет использование блока synchronized.

Получаем простенький класс:
```java
public class Counter {
  private int counter;
  public int incrementAndGet() {
    synchronized (this) {
      counter += 1;
      return counter;
    }
  }
  public int get() {
    synchronized (this) {
      return counter;
    }
  }
}
```
